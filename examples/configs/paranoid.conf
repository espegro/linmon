# ============================================================================
# LinMon Paranoid/Maximum Security Configuration
# ============================================================================
# Optimized for: High-security environments, incident response, forensic analysis
# Focus: Maximum visibility, comprehensive logging, zero blind spots
# Expected volume: 5000-50000+ events/day
#
# WARNING: This configuration generates VERY HIGH event volume and performance
# overhead. Only use in environments where security is paramount and resources
# are available to process and analyze high-volume logs.
#
# Use cases:
# - Incident response and forensic analysis
# - High-value targets (finance, defense, healthcare)
# - Systems under active investigation
# - Red team/blue team exercises
# - Security research and honeypots
# - Compliance requirements (PCI-DSS, HIPAA strict mode)

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

log_file = /var/log/linmon/events.json
log_to_syslog = true          # Redundant logging for tamper resistance
log_rotate = true
log_rotate_size = 500M        # Large files due to high volume
log_rotate_count = 50         # Keep extensive history
verbosity = 2                 # Verbose logging

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================

# EVERYTHING enabled
monitor_processes = true
monitor_process_exit = true   # Complete audit trail
monitor_files = true          # WARNING: Generates massive volume
monitor_tcp = true
monitor_udp = true            # Include DNS, NTP, all UDP traffic
monitor_vsock = true

# ============================================================================
# FILTERING CONFIGURATION
# ============================================================================

# NO FILTERING - monitor everything
min_uid = 0
max_uid = 0

# Log both TTY and non-TTY sessions
require_tty = false

# Log ALL threads (complete process tree)
ignore_threads = false

# NO process filtering
ignore_processes =
only_processes =

# ============================================================================
# NETWORK & FILE FILTERING
# ============================================================================

# NO network filtering - log ALL connections
ignore_networks =

# NO file path filtering - log ALL file operations
ignore_file_paths =

# ============================================================================
# ENRICHMENT & PRIVACY
# ============================================================================

capture_cmdline = true
redact_sensitive = true       # Still protect passwords (compliance requirement)
resolve_usernames = true
hash_binaries = true          # Critical for IOC matching
verify_packages = true        # Critical for unauthorized binary detection
capture_container_metadata = true

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================

# Larger caches for high-volume environments
# hash_cache_size = 50000
# pkg_cache_size = 50000
cache_save_interval = 1       # Save very frequently (data preservation)

# ============================================================================
# TAMPER DETECTION
# ============================================================================

checkpoint_interval = 5       # Very frequent integrity checks

# Authentication file integrity (CRITICAL for paranoid deployments)
monitor_auth_integrity = true  # Verify sshd, sudo, PAM configs
auth_integrity_interval = 5    # Match checkpoint frequency

# ============================================================================
# SECURITY MONITORING - ALL ENABLED
# ============================================================================

# ALL security detections enabled (no exceptions)
monitor_cred_read = true
monitor_cred_write = true
monitor_ldpreload = true
monitor_modules = true
monitor_memfd = true
monitor_execveat = true
monitor_bpf = true
monitor_log_tamper = true
monitor_ptrace = true         # Accept debugger false positives
monitor_bind = true           # Log all port bindings
monitor_unshare = true
monitor_persistence = true    # Log all persistence mechanisms
monitor_suid = true           # Log all SUID changes

# ============================================================================
# NOTES
# ============================================================================
# Expected event volume: 5,000-50,000+ events/day (highly variable)
# - Process exec: 1,000-5,000/day
# - Process exit: 1,000-5,000/day
# - File operations: 2,000-30,000/day (MASSIVE VOLUME)
# - Network TCP: 500-5,000/day
# - Network UDP: 200-2,000/day
# - Security: 50-500/day (many false positives, ALL require investigation)
#
# Performance impact: 5-15% CPU typical, can reach 20%+ on busy systems
# Disk usage: 500MB-5GB/day logs (depends on workload)
# Memory: 100-500MB for caches
#
# WARNING: File monitoring generates EXTREME volume
# - Desktop system: 10,000-50,000 file events/day
# - Compile server: 100,000+ file events/day
# - Database server: 50,000+ file events/day
# - Consider disabling monitor_files if volume is unmanageable
#
# Infrastructure Requirements:
# - Fast disk I/O for log writes (SSD recommended)
# - Sufficient disk space (monitor daily growth)
# - SIEM capable of ingesting 50-500 events/second
# - Adequate CPU resources (LinMon may consume 10-20% on busy systems)
# - Large memory for caches (increase hash_cache_size, pkg_cache_size)
#
# SIEM Integration Requirements:
# - High-performance log ingestion pipeline
# - Distributed search/analytics (Elasticsearch, Splunk, ClickHouse)
# - Automated baselining and anomaly detection
# - Alert fatigue mitigation (intelligent correlation)
# - Long-term log retention (compliance, forensics)
#
# Tuning Strategies:
# 1. Start with monitor_files = false, enable after baseline established
# 2. Use file path filtering (ignore_file_paths) for /tmp, /var/cache
# 3. Increase cache sizes to reduce disk lookups
# 4. Use SIEM-side filtering to reduce analyst workload
# 5. Implement automated threat hunting queries (package=null, etc.)
# 6. Create process behavior baselines per host
# 7. Use sampling for normal events, full logging for security events
#
# Forensic Analysis Benefits:
# - Complete process execution history
# - Full file modification timeline
# - Complete network connection graph
# - All privilege escalations and credential access
# - Container activity tracking
# - Persistence mechanism visibility
#
# False Positive Management:
# - Expect high false positive rate (acceptable for this use case)
# - Build comprehensive whitelist of known-good processes
# - Use machine learning for anomaly detection
# - Implement time-based analysis (unusual activity outside business hours)
# - Correlate multiple indicators (package=null + external network + persistence)
#
# Incident Response Mode:
# - Use this config when investigating active breach
# - Enable for 24-72 hours during IR, then revert to balanced config
# - Capture snapshots of system state before and after
# - Preserve logs for legal/compliance requirements
#
# Security Research Use Cases:
# - Malware analysis sandbox monitoring
# - Honeypot comprehensive logging
# - Red team exercise detection
# - Zero-day vulnerability research
# - Threat actor TTP documentation
#
# Compliance Scenarios:
# - PCI-DSS 10.2 (detailed audit trail)
# - HIPAA 164.312(b) (audit controls)
# - SOC 2 Type II (comprehensive monitoring)
# - NIST 800-53 AU family (audit and accountability)
# - GDPR Article 32 (security monitoring)
#
# NOT recommended for:
# - Desktop/laptop systems (unmanageable volume)
# - Production servers (performance impact)
# - Long-term continuous monitoring (cost prohibitive)
# - Low-security environments (overkill)
# - Resource-constrained systems
#
# ONLY use when:
# - Security requirements justify the cost
# - Resources available to analyze high-volume logs
# - SIEM infrastructure can handle the load
# - Legal/compliance mandate requires comprehensive logging
# - Active incident requiring maximum visibility
# - Research/honeypot requiring complete activity capture
