# ============================================================================
# LinMon Desktop/Laptop Configuration
# ============================================================================
# Optimized for: Personal workstations, developer laptops, desktop systems
# Focus: Low noise, minimal overhead, user activity monitoring
# Expected volume: 50-200 events/day
#
# This configuration monitors only the logged-in user's activity while
# filtering out noisy GUI applications (browsers, IDEs) and development tools.
# Suitable for personal security monitoring without impacting system performance.

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

log_file = /var/log/linmon/events.json
log_to_syslog = false
log_rotate = true
log_rotate_size = 50M
log_rotate_count = 5
verbosity = 1

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================

monitor_processes = true
monitor_process_exit = false  # Exit events rarely needed on desktop
monitor_files = false         # Too noisy (IDEs, builds, downloads)
monitor_tcp = true            # Track network connections to external hosts
monitor_udp = false           # DNS/mDNS creates too much noise
monitor_vsock = false         # Not relevant for desktop

# ============================================================================
# FILTERING CONFIGURATION
# ============================================================================

# Only monitor human user (not system services)
min_uid = 1000
max_uid = 0

# Desktop users typically don't use TTY sessions (GUI apps)
require_tty = false

# CRITICAL: Filter out browser/IDE thread noise
ignore_threads = true

# Optional: Filter noisy GUI apps (uncomment if needed)
# ignore_processes = chrome,firefox,electron,code,slack

# ============================================================================
# NETWORK FILTERING
# ============================================================================

# Filter private networks - only log external connections
ignore_networks = 127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16

# ============================================================================
# ENRICHMENT & PRIVACY
# ============================================================================

capture_cmdline = true
redact_sensitive = true
resolve_usernames = true
hash_binaries = true          # Useful for malware detection
verify_packages = true        # Detect untrusted binaries
capture_container_metadata = true  # Desktop may run Docker

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================

cache_save_interval = 10      # Save less frequently (desktop may suspend/hibernate)

# ============================================================================
# TAMPER DETECTION
# ============================================================================

checkpoint_interval = 60      # Hourly checkpoints (desktop runs intermittently)

# Authentication file integrity (optional for desktops, but recommended)
monitor_auth_integrity = true   # Verify sshd, sudo, PAM configs
auth_integrity_interval = 60    # Match checkpoint frequency

# ============================================================================
# SECURITY MONITORING - SELECTIVE (DESKTOP-APPROPRIATE)
# ============================================================================

# Core security detections (low noise)
monitor_cred_read = true
monitor_cred_write = true
monitor_ldpreload = true
monitor_modules = true
monitor_memfd = true
monitor_execveat = true
monitor_bpf = true
monitor_log_tamper = true

# Disable noisy detections (common on development machines)
monitor_ptrace = false        # gdb, strace, debuggers are common
monitor_bind = false          # Local dev servers (Node, Python, etc.)
monitor_unshare = false       # Docker, VMs
monitor_persistence = false   # Cron jobs, systemd services updated frequently
monitor_suid = false          # Package managers set SUID during installs

# ============================================================================
# NOTES
# ============================================================================
# Expected event volume: 50-200 events/day
# - Process exec: 20-100/day (apps, commands)
# - Network TCP: 20-100/day (web browsing, updates)
# - Security: 0-5/day (should investigate)
#
# Performance impact: <1% CPU typical
# Disk usage: ~5-20MB/day logs
#
# Recommended for:
# - Personal laptops and desktops
# - Developer workstations
# - Home office systems
# - Learning/testing LinMon
#
# NOT recommended for:
# - Production servers (use server.conf)
# - Multi-user systems (use bastion.conf)
# - Container hosts (use container-host.conf)
