# ============================================================================
# LinMon Configuration File
# ============================================================================
# Copy to /etc/linmon/linmon.conf and customize for your environment
#
# LinMon is an eBPF-based system monitoring tool for Linux, similar to
# Sysmon for Windows. It logs process execution, file operations, network
# activity, and privilege escalation events.

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Path to JSON event log file
# Events are logged in JSON Lines format (one JSON object per line)
log_file = /var/log/linmon/events.json

# Enable logging to syslog (in addition to file)
# Not yet implemented
log_to_syslog = false

# Verbosity level (0=quiet, 1=normal, 2=verbose)
verbosity = 1

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================

# Monitor process execution and termination
# Logs: process_exec, process_exit events
monitor_processes = true

# Monitor process exit events
# true  = Log both exec and exit events
# false = Only log exec events (reduces noise from thread cleanup)
# Note: Requires monitor_processes = true
monitor_process_exit = true

# Monitor file operations (create, modify, delete)
# Warning: Can generate significant event volume
# Logs: file_create, file_modify, file_delete events
monitor_files = false

# Monitor TCP connections (connect/accept)
# Logs: net_connect_tcp, net_accept_tcp events
# Supports both IPv4 and IPv6
monitor_tcp = true

# Monitor UDP traffic (sendmsg)
# Warning: UDP can be VERY noisy (DNS, NTP, DHCP, mDNS, etc.)
# Only enable if you need comprehensive network monitoring
# Logs: net_send_udp events
# Supports both IPv4 and IPv6
monitor_udp = false

# ============================================================================
# FILTERING CONFIGURATION
# ============================================================================

# UID filtering - only log events from users with UID >= min_uid
# Examples:
#   0    = Log all users including root and system users
#   1000 = Ignore system users (typical for Ubuntu/Debian)
#   500  = Ignore system users (typical for RHEL/CentOS older versions)
min_uid = 1000

# Maximum UID to monitor (0 = no limit)
# Use this to exclude high UID ranges if needed
max_uid = 0

# Require controlling TTY (terminal session)
# true  = Only log processes started from terminal (ssh, local terminal)
#         Good for: Auditing interactive user sessions
# false = Log all processes including GUI apps, desktop launchers, systemd services
#         Good for: Complete monitoring (Sysmon-like behavior)
# Recommendation: false for production monitoring
require_tty = false

# Ignore threads (only log main processes)
# true  = Only log main processes (pid == tgid), filter out threads
#         Good for: Reducing noise from Firefox/Chrome thread pools
# false = Log both main processes and threads
# Recommendation: true to reduce noise from browser/GUI app threads
ignore_threads = false

# ============================================================================
# PROCESS FILTERING
# ============================================================================

# Process name blacklist (comma-separated, exact match)
# Use this to reduce noise from chatty processes
# Examples:
#   ignore_processes = systemd,dbus-daemon,cron
#   ignore_processes = chrome,firefox,slack
ignore_processes =

# Process name whitelist (comma-separated, only log these if set)
# Leave empty to log all processes (subject to other filters above)
# Use this for focused monitoring of specific processes
# Example: only_processes = sshd,sudo,bash
only_processes =

# ============================================================================
# NETWORK & FILE PATH FILTERING
# ============================================================================

# Network CIDR filtering (comma-separated IPv4 CIDR blocks to ignore)
# Events TO these destination networks will be dropped in kernel before userspace
# Note: Only filters on destination address, not source
# Note: IPv4 only - IPv6 CIDR filtering not yet implemented
# Common examples:
#   10.0.0.0/8        - Private class A
#   172.16.0.0/12     - Private class B
#   192.168.0.0/16    - Private class C
#   127.0.0.0/8       - Loopback
#   169.254.0.0/16    - Link-local
# Leave empty to log all network traffic
# Example for common private networks:
#   ignore_networks = 127.0.0.0/8,192.168.0.0/16,10.0.0.0/8
ignore_networks =

# File path filtering (comma-separated path prefixes to ignore)
# Supports prefix matching - any file starting with these paths will be filtered
# Common examples:
#   /tmp/                 - All temporary files
#   /proc/                - Pseudo filesystem
#   /sys/                 - Kernel interface
#   /dev/                 - Device files
#   /var/cache/           - System cache
#   .cache/               - User cache directories
#   .local/share/Trash/   - Trash directories
# Leave empty to log all file operations (subject to monitor_files setting)
# Example:
#   ignore_file_paths = /tmp/,/proc/,/sys/,/dev/,.cache/
ignore_file_paths =

# ============================================================================
# ENRICHMENT & PRIVACY
# ============================================================================

# Capture full command-line arguments
# true  = Capture argv[] for all process_exec events
# false = Only capture process name
# Note: May contain sensitive data (passwords, tokens, API keys)
capture_cmdline = true

# Redact sensitive patterns in command lines
# Automatically removes passwords, tokens, and API keys from cmdline
# Patterns: password=, token=, api_key=, -p, --password, etc.
# Recommendation: Keep enabled if capture_cmdline is true
redact_sensitive = true

# Resolve UID to username (adds "username" field to events)
# Uses cached /etc/passwd lookups (256 entry cache)
# Minimal performance impact
resolve_usernames = true

# Calculate SHA256 hash of executed binaries
# Adds "sha256" field to process_exec events
# Uses LRU cache (1000 entries) to minimize disk I/O
# Note: Can impact performance for large binaries or high exec rate
# Recommendation: Enable for security monitoring, disable for high-volume systems
hash_binaries = false

# ============================================================================
# EXAMPLE CONFIGURATIONS
# ============================================================================

# Minimal monitoring (interactive sessions only):
#   monitor_processes = true
#   monitor_files = false
#   monitor_tcp = false
#   monitor_udp = false
#   min_uid = 1000
#   require_tty = true

# Sysmon-like (comprehensive monitoring):
#   monitor_processes = true
#   monitor_files = true
#   monitor_tcp = true
#   monitor_udp = false
#   min_uid = 0
#   require_tty = false

# Network-focused (DNS, web traffic):
#   monitor_processes = true
#   monitor_files = false
#   monitor_tcp = true
#   monitor_udp = true
#   min_uid = 1000

# Security audit (privilege escalation focus):
#   monitor_processes = true
#   monitor_files = false
#   monitor_tcp = false
#   monitor_udp = false
#   min_uid = 0
#   only_processes = sudo,su,pkexec,doas

# ============================================================================
# SECURITY MONITORING (MITRE ATT&CK Detection)
# ============================================================================
# These options enable detection of specific attack techniques.
# All are disabled by default to minimize noise. Enable based on your
# security requirements and threat model.

# Monitor ptrace() syscall - T1055 Process Injection detection
# Logs: security_ptrace events
# Detects: PTRACE_ATTACH, PTRACE_SEIZE, PTRACE_POKETEXT, PTRACE_POKEDATA
# Use case: Detect process injection, debugger attachment, memory manipulation
# Warning: Legitimate debuggers (gdb, strace, ltrace) will also trigger events
# Recommendation: Enable on high-security systems, review events for anomalies
monitor_ptrace = false

# Monitor kernel module loading - T1547.006 Rootkit/Driver detection
# Logs: security_module_load events
# Detects: init_module(), finit_module() syscalls
# Use case: Detect kernel rootkits, malicious drivers, unauthorized modules
# Note: Only root can load modules, but this detects unauthorized loading
# Recommendation: Enable on production servers, alert on any module load
monitor_modules = false

# Monitor memfd_create() - T1620 Fileless Malware detection
# Logs: security_memfd_create events
# Detects: Creation of anonymous executable memory regions
# Use case: Detect fileless malware, in-memory execution, ELF loaders
# Warning: Some legitimate software uses memfd (containers, JIT compilers)
# Recommendation: Enable on high-security systems, correlate with process exec
monitor_memfd = false